---
title: "РАСШИРЯЙТЕ ВОЗМОЖНОСТИ С API"
description: "Система amoCRM – удобная web программа для анализа продаж, доступная в режиме online из любой точки мира! Подробности узнавайте по указанным на сайте телефонам в Москве."
url: https://www.amocrm.ru/developers/content/digital/pipeline/site/visit
section: developers
---

Вы можете использовать данный тип события даже со сделками, созданными через API из Ваших форм. Для того, чтобы связать сделку с конкретным посетителем сайта, Вам нужно получить идентификатор этого посетителя и передать его через API вместе с данными создаваемой сделки.

### Получение идентификатора посетителя

Для получения идентификатора посетителя нужно разместить на Вашем сайте следующий код:

```

```

Данный код создаст глобальный объект **AMOPIXEL\_IDENTIFIER**. С помощью метода **“getVisitorUid”** данного объекта можно получить уникальный идентификатор посетителя:

```
var visitor\_uid = AMOPIXEL\_IDENTIFIER.getVisitorUid ( ) ;
```

Объект **AMOPIXEL\_IDENTIFIER** доступен только после полной его загрузки и инициализации.  
Вы можете указать callback-функцию, которая будет вызвана после полной инициализации объекта **AMOPIXEL\_IDENTIFIER**.

```
window.AMOPIXEL\_IDENTIFIER\_PARAMS = window.AMOPIXEL\_IDENTIFIER\_PARAMS || { } ;
window.AMOPIXEL\_IDENTIFIER\_PARAMS.onload = function (pixel\_identifier) {
var visitor\_uid = pixel\_identifier.getVisitorUid ( ) ; // Получаем visitor\_uid
console.log ( 'visitor\_uid' , visitor\_uid) ;
if (visitor\_uid) {
// Записываем его в скрытое поле формы 'visitor\_uid'
document.getElementById ( 'visitor\_uid' ).value = visitor\_uid;
}
} ;
```

Полученный идентификатор можно записать в скрытое поле Вашей формы, передать на Ваш сервер, а затем создать сделку через API amoCRM с указанием “visitor\_uid”:

#### **URL метода**

POST /api/v2/leads

```
{
"add" : [
{
"name" : "Заявка с сайта" ,
"status\_id" : 142 ,
"visitor\_uid" : "12345678-52d2-44c2-9e16-ba0052d9f6d6"
}
]
}
```

На стороне amoCRM произойдет связывание идентификатора посетителя **“visitor\_uid”** с id созданной сделки.

Далее, при заходе клиента на отслеживаемую страницу, сделка, связанная с ним, автоматически перейдет в настроенный этап.

**Примечание:** в качестве значения поля **“visitor\_uid”** можно использовать только идентификатор, полученный от **AMOPIXEL\_IDENTIFIER**. Формат идентификатора соответствует UUID. Если передать некорректное значение, оно будет проигнорировано.