---
title: "Digital Pipeline"
description: "Система amoCRM – удобная web программа для анализа продаж, доступная в режиме online из любой точки мира! Подробности узнавайте по указанным на сайте телефонам в Москве."
url: https://www.amocrm.ru/developers/content/web/sdk/digital/pipeline
section: developers
---

Digital Pipeline в amoCRM это удобный инструмент для автоматизации действий над сделками, а также добавлением новых источников сделок в аккаунт. В данном разделе для виджетов доступны следующие возможности кастомизации:

1. добавление собственного триггера
2. добавление нового канала сделок
3. модальное окно WhatsApp (если ваш виджет предоставляет возможность отправки сообщений в WhatsApp)
4. добавление виджета в SalesBot

### Триггеры

Триггером в Digital Pipeline мы называем автоматические действия, которые выполняются при срабатывании событий со сделками, которые настроил у себя пользователь.

Список доступных событий:

1. Добавление сделки
2. Смена статуса сделки
3. Смена статуса внутри растянутого действия виджета на несколько этапов\*
4. Входящее письмо
5. Входящий звонок
6. Посещение сайта
7. Входящее сообщение из чата
8. Добавление покупателя
9. Смена этапа покупателя
10. Смена статуса внутри растянутого действия

Виджет может реализовать собственный триггер в цифровой воронке через вебхук, в **manifest.json** необходимо указать свойство **dp/webhook\_url** [подробней см. здесь](https://www.amocrm.ru/developers/content/integrations/structure). Для работы с собственным триггером в браузере предусмотрен специальный колбэк, с помощью которого можно реализовывать собственную логику работы триггера и менять содержимое полей.

Для того, чтобы виджет начал работать в цифровой воронке в **manifest.json** необходимо указать область видимости **digital\_pipeline** и блок **dp/settings**.

```
{
...
"locations": [
"settings",
"digital\_pipeline"
],
"dp": {
"settings": {
"message": {
"name": "settings.message",
"type": "text",
"required": true
}
}
},
...
}
```

### Блок настройки триггера

После того, как ваш виджет будет успешно добавлен и инициализирован на аккаунте, доступ к его настройкам станет возможным из нескольких областей. В первую очередь доступ к полной настройке будет возможен стандартно, как и для всех интеграций, из раздела amoМаркет -> Установленные, подробнее [здесь](https://www.amocrm.ru/developers/content/web_sdk/settings). В случае если ваш виджет является интеграцией с digital pipeline, то к нему также появится доступ из настроек воронки, его можно будет выбрать в качестве триггера.

![](https://i.postimg.cc/CLv3xxyt/image3-1.png)

Этот элемент отрисовывается нами, включая логотип (logo\_dp.png 174px x 109px) и выбор условия, по которому будет выполняться действие вашего виджета. С вашей стороны необходимо наполнение элемента быстрыми настройками или выборами действий, которые будут совершаться, при наступлении выбранного пользователем условия.

Для примера опишем front-end часть виджета в script.js, которая отображает настройки внутри элемента быстрой настройки. Выберем отправку сообщения по наступлению какого-либо выбранного пользователем условия (см. скриншот выше).

Пример:

```
this.callbacks = {
...
dpSettings: function() {
//Код виджета, заданный в manifest.json
var w\_code = self.get\_settings().widget\_code,
lang = self.i18n('settings'),
// Благодря подстановке кода (w\_code) вашего виджета,
// мы можем обратиться к элементу содержащему именно ваш виджет
dp\_modal = $(".digital-pipeline\_\_short-task\_widget-style\_" + w\_code)
.parent()
.parent()
.find('[data-action=send\_widget\_hook]'),
// Ваши переводы к полям, описанные в ru.json
message\_label = dp\_modal.find('[title^=' + lang.message.split(" ")[0] + ']'),
message\_label\_new = lang.message,
// Обращение к введёному тексту
message\_input = dp\_modal.find('input[name=message]'),
//Отрисовываем поле ввода текста
message\_textarea = self.render(
{
ref: '/tmpl/controls/textarea.twig'
}, {
id: 'dp\_message',
style: {
'width': '396px',
'margin-top': '5px',
'margin-bottom': '-3px'
},
value: message\_input.val(),
placeholder: lang.message
}
);
message\_label.hide().after(message\_label\_new);
message\_input.hide().after(message\_textarea);
return true;
}
...
}
```

### Добавление нового канала сделок

Система позволяет добавлять новые каналы сделок, в терминологии amoCRM мы называем их источниками. Виджет может быть добавлен в список источников-виджетов (на скриншоте ниже), для этого в **manifest.json** должен быть указан локейшн "lead\_sources":

```
{
...
"locations": [
"lead\_sources"
],
...
}
```

### 

### Модальное окно WhatsApp

Для виджетов, которые поддерживают отправку сообщений в WhatsApp, предусмотрено специальное модальное окно, чтобы пользователю было проще найти такие интеграции.

В данном случае необходимо указать локейшн "**whatsapp\_modal**":

```
{
...
"locations": [
"whatsapp\_modal"
],
...
}
```

### 

### Добавление виджета в SalesBot

В amoCRM есть возможность подключить собственную цепочку действий в SalesBot. Данного бота можно запрограммировать на выполнение определенных действий.

Подробная инструкция по подключению, функционалу, настройке, языку и работе с нашим Salesbot в [соответствующем разделе](https://www.amocrm.ru/developers/content/web_sdk/salesbot-2).